{% load tools %}
{% load macros %}

{% macro display_runner runner %}
    <td class="text-center">{{runner.num}}</td>
    <td class="text-center">{{runner.last_name}}</td>
    <td class="text-center">{{runner.first_name}}</td>
    <td class="text-center">{{runner.gender}}</td>
    <td class="text-center">{{runner.age}}</td>
{% endmacro %}

{% macro display_category people %}
{{cat|key:people.category}}
{% if people.company %}
- {{people.company}}
{% elif people.category == 'STD' %}
- {{people.runner.school}}{{people.runner_1.school}}
{% endif %}
{% endmacro %}

{% macro display_team_results results cat order_by_time %}
    <table class="table table-striped table-bordered">
        <tr>
            <th class="text-center" rowspan="2">Nom équipe</th>
            <th class="text-center" colspan="6">Coureur 1</th>
            <th class="text-center" colspan="6">Coureur 2</th>
            <th class="text-center" colspan="6">Coureur 3</th>
            <th class="text-center" rowspan="2">Catégorie</th>
        </tr>
        <tr>
            <th class="text-center">Dossard</th>
            <th class="text-center">Nom</th>
            <th class="text-center">Prénom</th>
            <th class="text-center">Sexe</th>
            <th class="text-center">Age</th>
            <th class="text-center">Temps</th>
            <th class="text-center">Dossard</th>
            <th class="text-center">Nom</th>
            <th class="text-center">Prénom</th>
            <th class="text-center">Sexe</th>
            <th class="text-center">Age</th>
            <th class="text-center">Temps</th>
            <th class="text-center">Dossard</th>
            <th class="text-center">Nom</th>
            <th class="text-center">Prénom</th>
            <th class="text-center">Sexe</th>
            <th class="text-center">Age</th>s
            <th class="text-center">Temps</th>
        {% for r in results %}
            {% if order_by_time %}
                {% if not r.runner_1.time and not r.runner_2.time and not r.runner_3.time %}
                {# bypass empty team #}
                {% else %}
        <tr>
            <td class="text-center">{{r.name}}</td>
            {% usemacro display_runner r.runner_1 %}
            <td class="text-center">{{r.runner_1.time|default:"Temps en cours de récupération par l'équipe"}}</td>
            {% usemacro display_runner r.runner_2 %}
            <td class="text-center">{{r.runner_2.time|default:"Temps en cours de récupération par l'équipe"}}</td>
            {% usemacro display_runner r.runner_3 %}
            <td class="text-center">{{r.runner_3.time|default:"Temps en cours de récupération par l'équipe"}}</td>
            <td class="text-center">{% usemacro display_category r %}</td>
        </tr>
                {% endif %}
            {% else %}
        <tr>
            <td class="text-center">{{r.name}}</td>
            {% usemacro display_runner r.runner_1 %}
            <td class="text-center">{{r.runner_1.time}}</td>
            {% usemacro display_runner r.runner_2 %}
            <td class="text-center">{{r.runner_2.time}}</td>
            {% usemacro display_runner r.runner_3 %}
            <td class="text-center">{{r.runner_3.time}}</td>
            <td class="text-center">{% usemacro display_category r %}</td>
        </tr>
            {% endif %}
        {% endfor %}
    </table>
{% endmacro %}

{% macro display_individual_results results cat order_by_time %}
<table class="table table-striped table-bordered">
 <tr>
     <th class="text-center">Dossard</th>
     <th class="text-center">Nom</th>
     <th class="text-center">Prénom</th>
     <th class="text-center">Sexe</th>
     <th class="text-center">Age</th>
     <th class="text-center">Catégorie FFA</th>
     <th class="text-center">Catégorie</th>
     <th class="text-center">Temps</th>
 </tr>
        {% for r in results %}
            {% if order_by_time %}
                {% if r.runner.time %}
        <tr>
            {% usemacro display_runner r.runner %}
            <td class="text-center">{{r.runner.runner_category}}</td>
            <td class="text-center">{% usemacro display_category r %}</td>
            <td class="text-center">{{r.runner.time}}</td>
        </tr>
                {% endif %}
            {% else %}
        <tr>
            {% usemacro display_runner r.runner %}
            <td class="text-center">{{r.runner.runner_category}}</td>
            <td class="text-center">{% usemacro display_category r %}</td>
            <td class="text-center">{{r.runner.time}}</td>
        </tr>
            {% endif %}
        {% endfor %}
    </table>
{% endmacro %}
